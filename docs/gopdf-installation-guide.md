# gopdf ライブラリのインストールと使用方法

## 概要

このドキュメントでは、`signintech/gopdf` ライブラリのインストール手順と、PDF生成エンドポイントの実装について説明します。

## インストール手順

### 1. 依存関係のインストール

プロジェクトのルートディレクトリで以下のコマンドを実行してください：

```bash
cd backend
go mod tidy
```

これにより、`go.mod` ファイルに追加された `github.com/signintech/gopdf v0.29.0` がインストールされます。

### 2. フォントファイルの設置（オプション）

より美しいPDFを生成するために、フォントファイルを設置できます：

```bash
# backend ディレクトリ内でフォントディレクトリを作成
mkdir -p fonts

# フォントファイルをダウンロード（例：Noto Sans）
# 実際の環境では、適切なフォントファイルを配置してください
```

## 実装されたエンドポイント

### GET /dev/create-pdf

**説明**: "Test" という文字が書かれたPDFファイルを生成し、バックエンドサーバー内に保存します。

**リクエスト**:
```
GET http://localhost:8080/dev/create-pdf
```

**レスポンス**:
```json
{
  "success": true,
  "data": {
    "message": "PDFが正常に作成されました",
    "filename": "test_20240101_120000.pdf",
    "filepath": "./pdfs/test_20240101_120000.pdf"
  }
}
```

## 機能詳細

### PDF生成処理

1. **PDF文書の初期化**: A4サイズの新しいPDFドキュメントを作成
2. **フォント設定**: 利用可能なフォントを自動検出し、設定
3. **テキスト追加**: "Test" という文字をPDFに追加
4. **ファイル保存**: タイムスタンプ付きの一意なファイル名で保存

### ファイル保存場所

生成されたPDFファイルは、バックエンドサーバーの `./pdfs/` ディレクトリに保存されます。

### エラーハンドリング

- フォントファイルが見つからない場合は、基本的なテキスト描画にフォールバック
- PDFディレクトリの作成に失敗した場合は、適切なエラーメッセージを返す
- PDF保存に失敗した場合は、詳細なエラーメッセージを返す

## 使用方法

### 1. サーバーの起動

```bash
cd backend
go run main.go
```

### 2. PDF生成のテスト

```bash
curl http://localhost:8080/dev/create-pdf
```

### 3. 生成されたPDFの確認

```bash
ls -la backend/pdfs/
```

## 注意事項

- このエンドポイントは開発用として `/dev/` パスに配置されています
- 本番環境では適切な認証・認可を実装することを推奨します
- フォントファイルが未設置の場合でも、基本的な文字描画は機能します

## 今後の拡張予定

- 見積書PDFの生成機能
- カスタムフォントの対応
- 画像の埋め込み機能
- PDFテンプレートの作成機能